# Coverage configuration for Cold Email Infrastructure

[run]
# Source code paths to measure coverage for
source = src/email-infrastructure

# Directories to omit from coverage
omit = 
    */tests/*
    */test_*
    */__pycache__/*
    */venv/*
    */.venv/*
    */build/*
    */dist/*
    */migrations/*
    */scripts/*
    */docs/*
    */.git/*
    */node_modules/*
    */htmlcov/*
    .coverage*
    conftest.py
    setup.py

# Include patterns
include = 
    src/email-infrastructure/*

# Branch coverage
branch = true

# Parallel processing
parallel = true

# Data file location
data_file = .coverage

# Context settings
[run:context]
# Dynamic contexts for better reporting
dynamic_contexts = test_function

[report]
# Reporting options
show_missing = true
skip_covered = false
skip_empty = true
sort = Cover
precision = 2

# Coverage thresholds
fail_under = 85

# Exclude patterns from reporting
exclude_patterns =
    pragma: no cover
    def __repr__
    def __str__
    raise AssertionError
    raise NotImplementedError
    if __name__ == .__main__.:
    @(abc\.)?abstractmethod
    class .*\bProtocol\):
    @(typing\.)?overload

# Partial exclusions
partial_branches =
    pragma: no branch
    pragma: no cover

# Include context in reports
contexts = 
    test_*

[html]
# HTML report settings
directory = htmlcov
title = Cold Email Infrastructure Coverage Report
show_contexts = true
skip_covered = false
skip_empty = true
precision = 2

# Extra CSS for better styling
extra_css = tests/coverage/custom.css

[xml]
# XML report settings
output = coverage.xml
package_depth = 2

[json]
# JSON report settings  
output = coverage.json
pretty_print = true
show_contexts = true

[lcov]
# LCOV report settings
output = coverage.lcov

# System-specific coverage requirements
[coverage:paths]
# Path mapping for different environments
source =
    src/email-infrastructure
    */site-packages/email-infrastructure
    */lib/python*/site-packages/email-infrastructure

# Module-specific coverage requirements
[coverage:dns]
# DNS module coverage requirements
source = src/email-infrastructure/dns
fail_under = 95

[coverage:mailcow]
# Mailcow module coverage requirements  
source = src/email-infrastructure/mailcow
fail_under = 95

[coverage:vps]
# VPS module coverage requirements
source = src/email-infrastructure/vps
fail_under = 90

[coverage:monitoring]
# Monitoring module coverage requirements
source = src/email-infrastructure/monitoring
fail_under = 90

[coverage:common]
# Common module coverage requirements
source = src/email-infrastructure/common
fail_under = 85